/**
 * pacem v0.9.0-byblos (https://js.pacem.it)
 * Copyright 2020 Pacem (https://pacem.it)
 * Licensed under MIT
 */
var Pacem,__awaiter=this&&this.__awaiter||function(e,t,r,s){return new(r||(r=Promise))(function(a,i){function o(e){try{l(s.next(e))}catch(e){i(e)}}function n(e){try{l(s.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,n)}l((s=s.apply(e,t||[])).next())})},__decorate=this&&this.__decorate||function(e,t,r,s){var a,i=arguments.length,o=i<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,r):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,s);else for(var n=e.length-1;n>=0;n--)(a=e[n])&&(o=(i<3?a(o):i>3?a(t,r,o):a(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o};!function(e){!function(t){t.PermissionEditEventName="permissionedit";t.PermissionEditEvent=class PermissionEditEvent extends CustomEvent{constructor(e){super(t.PermissionEditEventName,{detail:e,cancelable:!1,bubbles:!0})}};t.Permissible=class Permissible{static canEdit(e,t){return this._canDoSomethingToResource(e,t,e=>e.update)}static canRead(e,t){return this._canDoSomethingToResource(e,t,e=>e.read)}static canAdd(e,t){return this._canDoSomethingToResource(e,t,e=>e.create)}static canDelete(e,t){return this._canDoSomethingToResource(e,t,e=>e.delete)}static canTranslate(e,t){return this._canDoSomethingToResource(e,t,e=>e.translate)}static _canDoSomethingToResource(t,r,s){if(e.Utils.isNullOrEmpty(t)||e.Utils.isNull(r))return!1;var a=!0;if(r.permissions&&r.permissions.length>0){a=!1;for(let e of r.permissions)if(s(e)&&t[e.claimType]&&t[e.claimType].indexOf(e.claimValue)>=0)return!0}return a}}}(e.Cms||(e.Cms={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){const r="pacem:metadatabag";t.SwaggerCmsParser=class SwaggerCmsParser{constructor(t=new e.Scaffolding.OpenApi.SwaggerParser){this._openApi=t,this._cachedMetadataUrls=[]}load(e,t){return __awaiter(this,void 0,void 0,function*(){let s=yield this._openApi.load(e,t);if(null!=s){s[r]={};for(let e of s.endpoints)yield this._enrichSchemas(s,e,t)}return s})}_enrichSchemas(e,t,r){return __awaiter(this,void 0,void 0,function*(){const s=t.response;s&&s.meta&&(s.fields=yield this._fetchMetadata(e,{name:s.fullType,schema:s.meta},r));const a=t.parameters;for(let t of a||[])if(t.meta&&t.fullType){let s=yield this._fetchMetadata(e,{name:t.fullType,schema:t.meta},r);t.fields=s}})}clearCache(){const e=this.cache,t=this._cachedMetadataUrls;if(e){for(let r of t)e.removeProperty(r);t.splice(0)}}_fetchMetadata(t,s,a){return __awaiter(this,void 0,void 0,function*(){let i=s=>__awaiter(this,void 0,void 0,function*(){let o=[];if(s&&s.name){if(t[r][s.name])return t[r][s.name];t[r][s.name]=o;let n,l={props:[]};if(!/^https?:\/\//.test(s.name))return void console.warn("Swagger entity definition keys must appear in form of absolute url. Their response to a GET request needs to be the entity metadata itself.\nNo other options are currently supported.");if(n=s.name){let e=()=>__awaiter(this,void 0,void 0,function*(){let e=yield fetch(n,{credentials:"omit",mode:"cors",headers:a});if(e.ok)return yield e.json()});this.cache?(l=this.cache.getPropertyValue(n))||(l=yield e(),this._cachedMetadataUrls.push(n),this.cache.setPropertyValue(n,l,!1)):l=yield e()}let c=s.schema;for(let s in c.properties){let a=c.properties[s],n=l&&l.props.find(e=>e.prop===s),d=Object.assign({prop:s,type:a.type||"text"},n||{isReadOnly:!0});if(n){let s=a.items&&a.items.$ref||a.$ref;if(s){let a=e.Scaffolding.OpenApi.getOpenApiDefinition(t,s),o=a.name;t[r][o]?d.props=t[r][o]:d.props=yield i(a)}}o.push(d)}}return o});return yield i(s)})}}}(t.OpenApi||(t.OpenApi={}))}(e.Cms||(e.Cms={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){t.Functions={dismiss:(...e)=>{for(let r of e||[])delete t.Functions[r]},handleExpressionValueChange:(t,r,s)=>{if("value"===t.detail.propertyName&&!e.Utils.isNull(s)){const a=t.detail.currentValue;if(s instanceof HTMLElement){let t=e.CustomElementUtils.camelToKebab(r);e.Utils.isNullOrEmpty(a)?s.removeAttribute(t):s.setAttribute(t,a.toString())}else s[r]=a}}},t.EXPRESSION_METADATA_TYPE=((t,r=":host",s=":host.entity")=>{const a={},i=t.metadata,o=e.Components.Cms.Functions,n=[];a.value=`{{ ${s} instanceof HTMLElement && ${s}.getAttribute('${e.CustomElementUtils.camelToKebab(i.prop)}') }}`,a["on-"+e.PropertyChangeEventName]=`Pacem.Components.Cms.Functions.handleExpressionValueChange($event, '${i.prop}', ${s})`,a.converter=`{{ Pacem.CustomElementUtils.getWatchedProperty(${s}, '${i.prop}').config.converter }}`;const l=e.P+"-expression";let c=i.extra||{};if(e.Utils.isNullOrEmpty(c.selector)||(a.selector=c.selector),!e.Utils.isNullOrEmpty(c.filter))switch(typeof c.filter){case"string":a.filter=`{{ (e) => e.constructor.name === "${c.filter}" || e.localName === "${c.filter.toLowerCase()}" }}`;break;case"function":const t="fn"+e.Utils.uniqueCode();o[t]=c.filter,a.filter=`{{ Pacem.Components.Cms.Functions.${t}, once }}`,n.push(t)}if("function"==typeof c.labeler){const t="fn"+e.Utils.uniqueCode();o[t]=c.labeler,a.labeler=`{{ Pacem.Components.Cms.Functions.${t}, once }}`,n.push(t)}return n.length>0&&(a["on-unload"]=`{{ Pacem.Components.Cms.Functions.dismiss('${n.join("','")}') }}`),{tagName:l,attrs:a}})}(t.Cms||(t.Cms={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){class PacemElementPickerElementBase extends e.Components.Scaffolding.PacemBaseElement{}__decorate([e.Watch({converter:e.PropertyConverters.String})],PacemElementPickerElementBase.prototype,"selector",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Eval})],PacemElementPickerElementBase.prototype,"filter",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Eval})],PacemElementPickerElementBase.prototype,"labeler",void 0),t.PacemElementPickerElementBase=PacemElementPickerElementBase;let r=class PacemElementPickerElement extends PacemElementPickerElementBase{get inputFields(){return[this._select]}toggleReadonlyView(e){this._select.readonly=e}onChange(t){return e.Utils.fromResult(this.value=this._select.value)}acceptValue(e){this._select.value=e}getViewValue(e){return this._select.viewValue}convertValueAttributeToProperty(t){return e.PropertyConverters.Element.convert(t)}viewActivatedCallback(){super.viewActivatedCallback(),this._databind()}propertyChangedCallback(e,t,r,s){if(super.propertyChangedCallback(e,t,r,s),!s)switch(e){case"selector":case"filter":case"labeler":this._databind()}}_databind(){const t=this.labeler||(e=>{let t=e.constructor.name;return e.id&&(t+="#"+e.id),t}),r=[];document.querySelectorAll(this.selector||"[pacem]").forEach((s,a,i)=>{!e.Utils.isNull(this.filter)&&!0!==this.filter(s)||e.Utils.isNullOrEmpty(s.id)||r.push({element:s,label:t(s)})}),this._select.valueProperty="element",this._select.textProperty="label",this._select.datasource=r}};__decorate([e.ViewChild(e.P+"-select")],r.prototype,"_select",void 0),__decorate([e.Debounce(50)],r.prototype,"_databind",null),r=__decorate([e.CustomElement({tagName:e.P+"-element-picker",shadow:e.Defaults.USE_SHADOW_ROOT,template:`<${e.P}-select></${e.P}-select>`})],r),t.PacemElementPickerElement=r}(t.Cms||(t.Cms={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){let r;!function(e){e.Constant="const",e.PropertyReference="property",e.Expression="expr"}(r=t.ExpressionSource||(t.ExpressionSource={}));let s=class PacemExpressionElement extends t.PacemElementPickerElementBase{propertyChangedCallback(t,s,a,i){if(super.propertyChangedCallback(t,s,a,i),"converter"===t)this._setFeedbackText(this.value);else if(!i&&this._editing)switch(t){case"_source":switch(a){case r.PropertyReference:this._picker.focus();break;default:this._editor.focus()}break;case"_propRef":e.Utils.isNullOrEmpty(a)||(this._editor.focus(),this._editor.value="{{ #"+this._sourceRef.id+"."+a+"  }}"),this.changeHandler(new Event("change"))}}get inputFields(){return[this._editor]}toggleReadonlyView(e){e&&(this._editing=!1)}setPristine(){super.setPristine(),this._editing=!1}onChange(t){return e.Utils.fromResult(this.value=this._editor.value)}acceptValue(e){this._view.textContent=e||"...",this._setFeedbackText(e),this._reverseStructure(),e!==this._editor.value&&(this._editor.value=e)}_setFeedbackText(t=this.value){const r=this.converter;e.CustomElementUtils.isBindingAttribute(t)||"function"!=typeof(r&&r.convert)?this._eval.setAttribute("text",t):this._eval.text=void 0===t?"<undefined>":r.convert(t)}getViewValue(e){return e}convertValueAttributeToProperty(e){return e}_reverseStructure(){let t=()=>{this._source=this._sourceRef=this._propRef=void 0},s=this.value;if(e.Utils.isNullOrEmpty(s))t();else if(e.CustomElementUtils.isBindingAttribute(s)){const t=e.CustomElementUtils.parseBindingAttribute(s,this).dependencies;if(e.Utils.isNullOrEmpty(t)||t.length>1)this._source=r.Expression;else{const e=t[0];this._source=r.PropertyReference,this._sourceRef=document.querySelector("#"+e.element.id),this._propRef=e.path}}else this._source=r.Constant}};__decorate([e.Watch({emit:!1})],s.prototype,"converter",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],s.prototype,"_editing",void 0),__decorate([e.Watch({converter:e.PropertyConverters.String})],s.prototype,"_source",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Element})],s.prototype,"_sourceRef",void 0),__decorate([e.Watch({converter:e.PropertyConverters.String})],s.prototype,"_propRef",void 0),__decorate([e.ViewChild(e.P+"-element-picker")],s.prototype,"_picker",void 0),__decorate([e.ViewChild(e.P+"-textarea")],s.prototype,"_editor",void 0),__decorate([e.ViewChild("span."+e.PCSS+"-viewfinder")],s.prototype,"_view",void 0),__decorate([e.ViewChild(e.P+"-text")],s.prototype,"_eval",void 0),__decorate([e.Debounce(50)],s.prototype,"_reverseStructure",null),s=__decorate([e.CustomElement({tagName:e.P+"-expression",shadow:e.Defaults.USE_SHADOW_ROOT,template:`<${e.P}-collapse class="${e.PCSS}-expression" collapse="{{ !:host._editing }}">\n    <div class="expression-builder ${e.PCSS}-grid grid-tiny-rowgap grid-tiny-colgap ${e.PCSS}-pad pad-bottom-2">\n        <div class="${e.PCSS}-cell">\n            <${e.P}-select value="{{ :host._source, twoway }}" class="display-block">\n                <${e.P}-data-item value="${r.Constant}" label="constant value"></${e.P}-data-item>\n                <${e.P}-data-item value="${r.PropertyReference}" label="property reference"></${e.P}-data-item>\n                <${e.P}-data-item value="${r.Expression}" label="complex expression"></${e.P}-data-item>\n            </${e.P}-select>\n        </div>\n\n        <${e.P}-panel class="${e.PCSS}-cell cols-hd-6" hide="{{ :host._source !== '${r.PropertyReference}' }}">\n            <${e.P}-element-picker value="{{ :host._sourceRef, twoway }}" selector="{{ :host.selector }}" filter="{{ :host.filter }}" labeler="{{ :host.labeler }}" class="display-block"></${e.P}-element-picker>\n        </${e.P}-panel>\n        <${e.P}-panel class="${e.PCSS}-cell cols-hd-6" hide="{{ :host._source !== '${r.PropertyReference}' }}">\n            <${e.P}-property-picker value="{{ :host._propRef, twoway }}" disabled="{{ !:host._sourceRef }}" target="{{ :host._sourceRef }}" on-change="::_editor.focus()" class="display-block"></${e.P}-property-picker>\n        </${e.P}-panel>\n\n        <${e.P}-panel class="${e.PCSS}-cell">\n            <${e.P}-textarea class="display-block" placeholder="{{ '{{ '+ (:host._source || '') +'... }}' }}" change-policy="${e.Components.Scaffolding.ChangePolicy.Blur}"></${e.P}-textarea>\n        </${e.P}-panel>\n    </div>\n</${e.P}-collapse>\n<div class="${e.PCSS}-fieldset">\n    <div class="fieldset-left">\n        <div class="${e.PCSS}-fieldgroup ${e.PCSS}-viewfinder">\n            <div><span class="text-ellipsed ${e.PCSS}-viewfinder display-block text-tech ${e.PCSS}-pad pad-left-1 pad-right-1">{{ :host.value || '...' }}</span></div>\n            <${e.P}-panel class="fieldgroup-prepend">\n                <${e.P}-button class="flat edit ${e.PCSS}-pad pad-left-1" on-click=":host._editing = !:host._editing" hide="{{ :host.readonly }}"></${e.P}-button>\n            </${e.P}-panel>\n            <${e.P}-panel class="fieldgroup-append text-tech display-flex flex-middle flex-nowrap" hide="{{ $pacem.isNullOrEmpty(:host.value) }}">\n                <i class="${e.PCSS}-icon text-primary">keyboard_arrow_right</i>\n                <${e.P}-text text="?" class="bg-primary ${e.PCSS}-pad pad-left-1 pad-right-1 ${e.PCSS}-margin margin-right-1 text-truncate" eval></${e.P}-text>\n            </${e.P}-panel>\n        </div>\n    </div>\n</div>`})],s),t.PacemExpressionElement=s}(t.Cms||(t.Cms={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(r){const s={props:[{prop:"permissions",type:"array",display:{name:"Permissions"},props:{display:{cssClass:[e.PCSS+"-cell",e.PCSS+"-grid","grid-novgap","grid-tiny-colgap","grid-nospace"],name:"Permission"},props:Array.prototype.concat.apply([{prop:"claimType",type:"string",display:{cssClass:[e.PCSS+"-cell","cols-hd-4","cols-lg-6","field-stretch","field-minimal"],name:"Claim type"},validators:[{type:"required",errorMessage:"!"}]},{prop:"claimValue",type:"string",display:{cssClass:[e.PCSS+"-cell","cols-hd-4","cols-lg-6","field-stretch","field-minimal"],name:"Claim value"},validators:[{type:"required",errorMessage:"!"}]}],["read","update","create","delete"].map((t,r)=>({prop:t,type:"boolean",display:{cssClass:[e.PCSS+"-cell","cols-hd-1","cols-3","field-minimal",e.PCSS+"-pad pad-left-2"],name:t.charAt(0).toUpperCase()+t.substr(1)}})))}}]};function a(t){t.display=t.display||{name:t.prop,cssClass:[]},(t.display.cssClass=t.display.cssClass||[]).push(e.PCSS+"-cell")}r.DEFAULT_METADATA={display:{name:"Widget",cssClass:[e.PCSS+"-grid","grid-novgap","grid-tiny-colgap","grid-nospace"]},props:[{prop:"tag",type:"string",display:{name:"Tag",cssClass:[e.PCSS+"-cell"]}}]},r.gridifyMetadata=function(t){var s=t&&t.props||[],i=t&&t.display||{name:"Element"};if(!e.Utils.isNull(i)){const e=i.cssClass=i.cssClass||[];Array.prototype.push.apply(e,r.DEFAULT_METADATA.display.cssClass)}return s.forEach(a),{display:i,props:s}},r.buildWidgetMetadata=function(t){var s=e.Utils.extend({},r.DEFAULT_METADATA.display,t&&t.display||{}),i=e.Utils.clone(r.DEFAULT_METADATA.props);return Array.prototype.push.apply(i,(t&&t.props||[]).filter(e=>"tag"!==e.prop&&(a(e),!0))),{display:s,props:i}};const i=e.PCSS+"-widget";r.EXPRESSION_WIDGET_METADATA_EXTRA={selector:"."+i,labeler:t=>e.Utils.isNullOrEmpty(t.tag)?(t.metadata&&t.metadata.display&&t.metadata.display.name||"")+"#"+t.id:t.tag};r.Widget=class Widget{static findAll(t){return e.CustomElementUtils.findAll("."+i,r=>r instanceof PacemWidgetElement&&!e.Utils.isNullOrEmpty(r.id)&&(e.Utils.isNull(t)||t(r)))}};let o=class PacemWidgetToolbarElement extends t.PacemElement{get editButton(){return this._btnEdit}get permissionsButton(){return this._btnPerms}get removeButton(){return this._btnRemove}_edit(e){const t=this._proxy.dom.find(e=>"core"in e.attributes);t.open(this.target),t.metadata=this.target.metadata,this._popoutJustInCase()}_editPermissions(e){const t=this._proxy.dom.find(e=>"permissions"in e.attributes);t.open(this.target),t.metadata=this.target.permissionMetadata,this._popoutJustInCase()}_popoutJustInCase(){const t=e.CustomElementUtils.findAncestorOfType(this,e.Components.UI.PacemBalloonElement);e.Utils.isNullOrEmpty(t)||t.popout()}};__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Element})],o.prototype,"target",void 0),__decorate([e.ViewChild(".buttons > div")],o.prototype,"_toolbar",void 0),__decorate([e.ViewChild(e.P+"-button[edit]")],o.prototype,"_btnEdit",void 0),__decorate([e.ViewChild(e.P+"-button[permissions]")],o.prototype,"_btnPerms",void 0),__decorate([e.ViewChild(e.P+"-button[remove]")],o.prototype,"_btnRemove",void 0),__decorate([e.ViewChild(e.P+"-shell-proxy")],o.prototype,"_proxy",void 0),o=__decorate([e.CustomElement({tagName:e.P+"-widget-toolbar",shadow:e.Defaults.USE_SHADOW_ROOT,template:`<${e.P}-span class="toolbar-text" content="{{ '<i class=&quot;${e.PCSS}-icon&quot;>'+ (::target.metadata && ::target.metadata.display && ::target.metadata.display.icon || 'widgets') +'</i> '+ (::target.tag || (::target.metadata && ::target.metadata.display && ::target.metadata.display.name || ::target.localName) +'#'+ ::target.id) }}"></${e.P}-span>\n<div class="buttons ${e.PCSS}-buttonset ${e.PCSS}-pad ${e.PCSS}-margin pad-0 margin-left-2">\n    <div class="buttonset-left">\n        <${e.P}-button edit class="button edit" on-click=":host._edit($event)"></${e.P}-button>\n        <${e.P}-button permissions class="button" on-click=":host._editPermissions($event)" css-class="{{ {'button-success': ::target.permissions.length > 0} }}" icon-glyph="verified_user"></${e.P}-button>\n        <${e.P}-button remove class="button button-danger delete"></${e.P}-button>\n    </div>\n<div>\n<${e.P}-shell-proxy>\n    <${e.P}-modal-form autogenerate="true" core></${e.P}-modal-form>\n    <${e.P}-modal-form autogenerate="true" permissions></${e.P}-modal-form>\n</${e.P}-shell-proxy>`})],o),r.PacemWidgetToolbarElement=o;class PacemWidgetElement extends t.PacemElement{constructor(e,t="widget"){super(t),this.permissionMetadata=s,this.metadata=e}connectedCallback(){super.connectedCallback(),e.Utils.isNullOrEmpty(this.id)&&(this.id="wdg"+e.Utils.uniqueCode()),e.Utils.addClass(this,i)}propertyChangedCallback(t,r,s,a){switch(super.propertyChangedCallback(t,r,s,a),t){case"editable":s?this.isReady&&this._ensureBalloon():this._disposeBalloon();break;case"editing":e.Utils.isNull(this._balloon)||(this._balloon.disabled=!s),(s?e.Utils.addClass:e.Utils.removeClass).apply(this,[this,"widget-"+t]);break;case"metadata":this._assignIcon(s)}}viewActivatedCallback(){super.viewActivatedCallback(),this._assignIcon(),this._ensureBalloon()}disconnectedCallback(){super.disconnectedCallback()}_assignIcon(e=this.metadata){this.dataset.icon=e&&e.display&&e.display.icon||"widgets"}_ensureBalloon(){if(e.Utils.isNull(this._balloon)){const r=this._balloon=document.createElement(e.P+"-balloon");r.target=this,r.disabled=!this.editing,r.options={behavior:t.UI.BalloonBehavior.Menu,trigger:t.UI.BalloonTrigger.Hover},r.innerHTML=`<${e.P}-widget-toolbar target="{{ #${this.id} }}"><${e.P}-widget-toolbar>`,e.CustomElementUtils.findAncestorShell(this).appendChild(r)}}_disposeBalloon(){e.Utils.isNull(this._balloon)||(this._balloon.remove(),this._balloon=null)}}__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Boolean})],PacemWidgetElement.prototype,"editing",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Boolean})],PacemWidgetElement.prototype,"editable",void 0),__decorate([e.Watch({emit:!0,reflectBack:!0,converter:e.PropertyConverters.String})],PacemWidgetElement.prototype,"tag",void 0),__decorate([e.Watch({emit:!1,reflectBack:!0,converter:e.PropertyConverters.Json})],PacemWidgetElement.prototype,"permissions",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Json})],PacemWidgetElement.prototype,"metadata",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Json})],PacemWidgetElement.prototype,"permissionMetadata",void 0),r.PacemWidgetElement=PacemWidgetElement}(t.Cms||(t.Cms={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){t.FETCH_CREDENTIALS_METADATA={prop:"fetchCredentials",type:"string",dataType:"enumeration",display:{name:"Fetch Credentials"},extra:{enum:["same-origin","omit","include"]}},t.ACCESS_TOKEN_METADATA={prop:"accessToken",type:"string",display:{name:"Access Token",ui:"expression"}};class PacemBearerWidgetElement extends t.PacemWidgetElement{constructor(){super(...arguments),this.fetchCredentials="same-origin"}propertyChangedCallback(t,r,s,a){super.propertyChangedCallback(t,r,s,a),"accessToken"===t&&(e.Utils.isNullOrEmpty(s)?this.fetchHeaders={}:this.fetchHeaders={Authorization:"Bearer "+s})}}__decorate([e.Watch({emit:!1,reflectBack:!0,converter:e.PropertyConverters.String})],PacemBearerWidgetElement.prototype,"fetchCredentials",void 0),__decorate([e.Watch({emit:!1,converter:e.PropertyConverters.Json})],PacemBearerWidgetElement.prototype,"fetchHeaders",void 0),__decorate([e.Watch({emit:!1,reflectBack:!0,converter:e.PropertyConverters.String})],PacemBearerWidgetElement.prototype,"accessToken",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],PacemBearerWidgetElement.prototype,"fetching",void 0),t.PacemBearerWidgetElement=PacemBearerWidgetElement}(t.Cms||(t.Cms={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){const r={display:{icon:"cloud_circle",name:"Api Manifest",description:"OpenApi parser for WebApi scaffolding."},props:[{prop:"url",type:"text",display:{name:"Url",description:"Insert the url of the OpenApi json configuration.",cssClass:["cols-lg-8"],watermark:"https://domain.com/swagger/v1/swagger.json"},extra:{tooltip:!0},validators:[{type:"required",errorMessage:"Url field is required."}]},{prop:"usecache",type:"boolean",display:{name:"Cache results",description:"Whether to cache the manifest per-url.",cssClass:["cols-lg-4"],ui:"switcher"},extra:{tooltip:!0}},t.ACCESS_TOKEN_METADATA]};let s=class PacemWidgetApiManifestElement extends t.PacemBearerWidgetElement{constructor(s=new e.Cms.OpenApi.SwaggerCmsParser,a=new e.Storage){super(t.buildWidgetMetadata(r)),this._openapi=s,this._cache=a}propertyChangedCallback(e,t,r,s){switch(super.propertyChangedCallback(e,t,r,s),e){case"url":case"editing":case"editable":this._scaffold();break;case"usecache":this._openapi.cache=r?this._cache:null}}viewActivatedCallback(){super.viewActivatedCallback(),this.usecache&&(this._openapi.cache=this._cache),this._scaffold()}_scaffold(){this.editing&&this.editable&&!e.Utils.isNullOrEmpty(this.url)&&(this.fetching=!0,this._openapi.load(this.url).then(e=>{this.manifest=e,this.fetching=!1},e=>{this.fetching=!1}))}};__decorate([e.Watch({emit:!1,reflectBack:!0,converter:e.PropertyConverters.String})],s.prototype,"url",void 0),__decorate([e.Watch({emit:!1,reflectBack:!0,converter:e.PropertyConverters.Boolean})],s.prototype,"usecache",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Json})],s.prototype,"manifest",void 0),s=__decorate([e.CustomElement({tagName:e.P+"-widget-apimanifest"})],s),t.PacemWidgetApiManifestElement=s}(t.Cms||(t.Cms={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){const r={display:{icon:"timer",name:"Clock",description:"Timer widget."},props:[{prop:"interval",type:"number",display:{name:"Interval (msec)"},extra:{selector:"."+e.PCSS+"-widget",step:1e3},validators:[{type:"range",errorMessage:"Negative numbers not allowed",params:{min:0}}]}]};let s=class PacemWidgetClockElement extends t.PacemWidgetElement{constructor(){super(t.buildWidgetMetadata(r)),this.interval=0}};__decorate([e.Watch({reflectBack:!0,converter:e.PropertyConverters.Number})],s.prototype,"interval",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Number})],s.prototype,"time",void 0),s=__decorate([e.CustomElement({tagName:e.P+"-widget-clock",template:`<${e.P}-timer interval="{{ :host.interval }}" on-tick="{{ :host.time = Date.now() }}"></${e.P}-timer>`})],s),t.PacemWidgetClockElement=s}(t.Cms||(t.Cms={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){const r={display:{icon:"storage",name:"Data",description:"Data object widget."},props:[{prop:"model",type:t.EXPRESSION_METADATA_TYPE,display:{name:"Model"},extra:{selector:"."+e.PCSS+"-widget"}}]};let s=class PacemWidgetDataElement extends t.PacemWidgetElement{constructor(){super(t.buildWidgetMetadata(r))}};__decorate([e.Watch({reflectBack:!0,converter:e.PropertyConverters.Json})],s.prototype,"model",void 0),s=__decorate([e.CustomElement({tagName:e.P+"-widget-data"})],s),t.PacemWidgetDataElement=s}(t.Cms||(t.Cms={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(r){const s={props:[{prop:"name",type:"string",isReadOnly:!0,display:{name:"Name",cssClass:["cols-md-4","cols-lg-3","cols-hd-2"]}},{prop:"value",type:r.EXPRESSION_METADATA_TYPE,display:{name:"Value",cssClass:["cols-md-8","cols-lg-9","cols-hd-10"]}}]},a={display:{icon:"wifi",name:"Api Fetcher",description:"Fetching widget that retrieves data from a REST endpoint."},props:[{prop:"manifest",type:r.EXPRESSION_METADATA_TYPE,isComplexType:!0,display:{name:"Api Manifest"},extra:{selector:e.P+"-widget-apimanifest"},validators:[{type:"required",errorMessage:"Api Manifest is a required field."}]},{prop:"endpoint",type:"object",isComplexType:!0,display:{name:"Endpoint",ui:"oneToMany"},validators:[{type:"required",errorMessage:"Api Manifest is a required field."}],extra:{source:t=>t.endpoints.map(t=>e.Utils.extend(t,{fullPath:`[${t.method.toUpperCase()}] ${t.path}`})).sort(),textProperty:"fullPath",valueProperty:"fullPath",dependsOn:[{prop:"manifest",hide:!0}]}},{prop:"parameters",type:"array",display:{name:"Parameters"},props:r.gridifyMetadata(s),extra:{lockItems:!0,dependsOn:[{prop:"endpoint",hide:!0}]}},r.ACCESS_TOKEN_METADATA]},i=e.P+"-widget-fetch-parameter";let o=class PacemWidgetFetchParameterElement extends t.PacemEventTarget{propertyChangedCallback(t,r,s,a){super.propertyChangedCallback(t,r,s.first),"value"!==t||e.Utils.isNull(this._fetcher)||this._fetcher.fetch()}viewActivatedCallback(){super.viewActivatedCallback();this._fetcher=e.CustomElementUtils.findAncestorOfType(this,n);e.Utils.isNull(this._fetcher)||e.Utils.isNull(this.value)||this._fetcher.fetch()}};__decorate([e.Watch({reflectBack:!0,converter:e.PropertyConverters.Boolean})],o.prototype,"required",void 0),__decorate([e.Watch({reflectBack:!0,converter:e.PropertyConverters.String})],o.prototype,"name",void 0),__decorate([e.Watch({reflectBack:!0,converter:e.PropertyConverters.String})],o.prototype,"value",void 0),o=__decorate([e.CustomElement({tagName:i})],o),r.PacemWidgetFetchParameterElement=o;let n=class PacemWidgetFetchElement extends r.PacemBearerWidgetElement{constructor(){super(r.buildWidgetMetadata(a)),this._onerror=(e=>{this.failure=!(this.success=!1)}),this._onsuccess=(e=>{this.failure=!(this.success=!0)}),this._onresult=(e=>{this.result=e.detail})}get _parameters(){return Array.from(this._itemsElement.children).filter(e=>e.localName===i)}fetch(){const t=this._fetcher,r=this._parameters||[],s=this.endpoint;if(!e.Utils.isNull(s))for(let t of s.parameters)if(t.required&&e.Utils.isNull(r.find(e=>e.name===t.name)))return;const a={};for(let t of r)if(e.Utils.isNullOrEmpty(t.value)){if(t.required)return}else a[t.name]=t.value;return t.url=this.url,t.method=this.method,t.credentials=this.fetchCredentials,t.headers=this.fetchHeaders,t.parameters=a,t.fetch()}viewActivatedCallback(){super.viewActivatedCallback(),this.fetch()}propertyChangedCallback(t,r,s,a){if(super.propertyChangedCallback(t,r,s,a),"endpoint"!==t||e.Utils.isNullOrEmpty(s))switch(t){case"parameters":case"fetchHeaders":case"fetchCredentials":case"url":case"method":this.fetch()}else this._mergeEndpoint(s)}_mergeEndpoint(t=this.endpoint){this.url=this.manifest.baseUrl+t.path,this.method=t.method,this.fields=t.response.fields;const r=this._itemsElement,s=this._parameters;for(let r=s.length-1;r>=0;r--){let a=s[r],i=t.parameters.find(e=>e.name===a.name);e.Utils.isNull(i)&&a.remove()}for(let a of t.parameters){let t=s.find(e=>e.name===a.name);if(e.Utils.isNull(t)){let e=t=document.createElement(i);e.name=a.name,r.appendChild(e)}t.required=a.required}this.parameters=s}};__decorate([e.Watch({reflectBack:!0,emit:!0,converter:e.PropertyConverters.Json})],n.prototype,"manifest",void 0),__decorate([e.Watch({reflectBack:!0,emit:!0,converter:e.PropertyConverters.Json})],n.prototype,"endpoint",void 0),__decorate([e.Watch({reflectBack:!0,emit:!1,converter:e.PropertyConverters.String})],n.prototype,"url",void 0),__decorate([e.Watch({reflectBack:!0,emit:!1,converter:e.PropertyConverters.String})],n.prototype,"method",void 0),__decorate([e.Watch({reflectBack:!0,emit:!1,converter:e.PropertyConverters.Json})],n.prototype,"fields",void 0),__decorate([e.Watch()],n.prototype,"parameters",void 0),__decorate([e.Watch()],n.prototype,"result",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],n.prototype,"fetching",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],n.prototype,"success",void 0),__decorate([e.Watch({converter:e.PropertyConverters.Boolean})],n.prototype,"failure",void 0),__decorate([e.ViewChild(e.P+"-fetch")],n.prototype,"_fetcher",void 0),__decorate([e.ViewChild("div[hidden]")],n.prototype,"_itemsElement",void 0),n=__decorate([e.CustomElement({tagName:e.P+"-widget-fetch",shadow:e.Defaults.USE_SHADOW_ROOT,template:`<${e.P}-fetch autofetch="false" fetching="{{ :host.fetching, twoway }}" debounce="100"\non-${e.Net.FetchResultEventName}=":host._onresult($event)" on-${e.Net.FetchErrorEventName}=":host._onerror($event)" on-${e.Net.FetchSuccessEventName}=":host._onsuccess($event)"></${e.P}-fetch><div hidden><${e.P}-content></${e.P}-content></div>`})],n),r.PacemWidgetFetchElement=n}(t.Cms||(t.Cms={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){let r=class PacemWidgetTranslatorElement extends t.PacemWidgetElement{};r=__decorate([e.CustomElement({tagName:e.P+"-widget-translator"})],r),t.PacemWidgetTranslatorElement=r}(t.Cms||(t.Cms={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){class PacemUiWidgetElement extends t.PacemWidgetElement{constructor(e,t=1,r){super(e,r),this.colspan=t,this.rowspan=1}connectedCallback(){super.connectedCallback(),e.Utils.addClass(this,"ui-widget "+e.PCSS+"-cell cols-xs-start-1 cols-xs-12 rows-xs-start-auto")}propertyChangedCallback(t,r,s,a){switch(super.propertyChangedCallback(t,r,s,a),t){case"row":e.Utils.removeClass(this,`rows-start-${r+1}`),e.Utils.addClass(this,`rows-start-${s+1}`);break;case"rowspan":e.Utils.removeClass(this,`rows-${r}`),e.Utils.addClass(this,`rows-${s}`);break;case"column":e.Utils.removeClass(this,`cols-start-${r+1}`),e.Utils.addClass(this,`cols-start-${s+1}`);break;case"colspan":e.Utils.removeClass(this,`cols-${r}`),e.Utils.addClass(this,`cols-${s}`);break;case"borders":(this.borders?e.Utils.addClass:e.Utils.removeClass).apply(this,[this,e.PCSS+"-border"]);break;case"corners":(this.borders?e.Utils.addClass:e.Utils.removeClass).apply(this,[this,e.PCSS+"-corners"])}}get container(){return this._container}findContainer(){return e.CustomElementUtils.findAncestor(this,e=>e instanceof PacemCompositeWidgetElement)}viewActivatedCallback(){super.viewActivatedCallback();let t=this._container=this.findContainer();e.Utils.isNull(t)||t.register(this)}disconnectedCallback(){e.Utils.isNull(this._container)||this._container.unregister(this),super.disconnectedCallback()}}__decorate([e.Watch({emit:!0,reflectBack:!0,converter:e.PropertyConverters.Number})],PacemUiWidgetElement.prototype,"column",void 0),__decorate([e.Watch({emit:!0,reflectBack:!0,converter:e.PropertyConverters.Number})],PacemUiWidgetElement.prototype,"row",void 0),__decorate([e.Watch({emit:!0,reflectBack:!0,converter:e.PropertyConverters.Number})],PacemUiWidgetElement.prototype,"colspan",void 0),__decorate([e.Watch({emit:!0,reflectBack:!0,converter:e.PropertyConverters.Number})],PacemUiWidgetElement.prototype,"rowspan",void 0),__decorate([e.Watch({emit:!0,reflectBack:!0,converter:e.PropertyConverters.Boolean})],PacemUiWidgetElement.prototype,"borders",void 0),__decorate([e.Watch({emit:!0,reflectBack:!0,converter:e.PropertyConverters.Boolean})],PacemUiWidgetElement.prototype,"corners",void 0),t.PacemUiWidgetElement=PacemUiWidgetElement,t.WidgetRegisterEventName="widgetregister",t.WidgetUnregisterEventName="widgetunregister",t.LayoutChangeEventName="layoutchange";class WidgetRegisterEvent extends CustomEvent{constructor(r,s){super(t.WidgetRegisterEventName,e.Utils.extend(s||{},{detail:r}))}}t.WidgetRegisterEvent=WidgetRegisterEvent;class WidgetUnregisterEvent extends CustomEvent{constructor(r,s){super(t.WidgetUnregisterEventName,e.Utils.extend(s||{},{detail:r}))}}t.WidgetUnregisterEvent=WidgetUnregisterEvent;class PacemCompositeWidgetElement extends PacemUiWidgetElement{get itemsElement(){return this}validate(e){return e instanceof PacemUiWidgetElement}viewActivatedCallback(){super.viewActivatedCallback(),e.Utils.addClass(this.itemsElement,e.PCSS+"-items-element")}appendItem(e){this.itemsElement.appendChild(e)}register(t){if(!this.validate(t))return this.log(e.Logging.LogLevel.Debug,`${t&&t.localName} element couldn't be registered in a ${this.localName} element.`),!1;let r=!1;const s=this.items=this.items||[];return e.Utils.isNullOrEmpty(s)?(this.items=[t],r=!0):-1===s.indexOf(t)&&(s.push(t),r=!0),r&&this.dispatchEvent(new WidgetRegisterEvent(t)),r}unregister(t){const r=this.items,s=!e.Utils.isNullOrEmpty(r)&&r.indexOf(t);if(s>=0){let e=r.splice(s,1);return this.dispatchEvent(new WidgetUnregisterEvent(e[0])),!0}return!1}}__decorate([e.Watch()],PacemCompositeWidgetElement.prototype,"items",void 0),t.PacemCompositeWidgetElement=PacemCompositeWidgetElement}(t.Cms||(t.Cms={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){const r=t.buildWidgetMetadata({display:{icon:"font_download",name:"Text",description:"Plain text widget."},props:[{prop:"text",type:t.EXPRESSION_METADATA_TYPE,display:{name:"Text"},extra:t.EXPRESSION_WIDGET_METADATA_EXTRA}]});let s=class PacemWidgetTextElement extends t.PacemUiWidgetElement{constructor(){super(r)}};__decorate([e.Watch({reflectBack:!0,converter:e.PropertyConverters.String})],s.prototype,"text",void 0),s=__decorate([e.CustomElement({tagName:e.P+"-widget-text",shadow:e.Defaults.USE_SHADOW_ROOT,template:`<${e.P}-text text="{{ :host.text }}"></${e.P}-text>`})],s),t.PacemWidgetTextElement=s}(t.Cms||(t.Cms={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){function r(){const e=document.createElementNS("http://www.w3.org/2000/svg","svg");return e.style.pointerEvents="none",e.style.zIndex="1000",e.setAttribute("height","100%"),e.setAttribute("width","100%"),e.setAttribute("preserveAspectRatio","none"),e.innerHTML='<rect class="grid-cell" height="100%" width="100%"></rect>',e}t.GRID_COLUMNS=12;const s=t.GRID_COLUMNS,a={display:{icon:"grid_on",name:"Grid",description:"Composition Widget that lays out child-widgets in a grid container."},props:[{prop:"rows",type:"int",display:{name:"Rows",cssClass:["cols-lg-4"]},validators:[{type:"required",errorMessage:""},{type:"range",errorMessage:"",params:{min:1,max:24}}]},{prop:"rowGap",type:"int",display:{name:"Row gap",cssClass:["cols-lg-4"]},validators:[{type:"range",errorMessage:"",params:{min:0,max:3,step:.25}}]},{prop:"columnGap",type:"int",display:{name:"Column gap",cssClass:["cols-lg-4"]},validators:[{type:"range",errorMessage:"",params:{min:0,max:3,step:.25}}]}]};let i=class PacemGridWidgetElement extends t.PacemCompositeWidgetElement{constructor(){super(t.buildWidgetMetadata(a),s,"grid"),this._widgetPropertyChange=(e=>{if("row"===e.detail.propertyName||"rowspan"===e.detail.propertyName){const t=e.target;this.rows=Math.max(this.rows,t.row+t.rowspan)}}),this._dragDropHandler=(t=>{const r=t.detail,a=r.element;switch(t.type){case e.UI.DragDropEventType.Start:this._gridBoxes.forEach(e=>{e.style.pointerEvents="auto"}),this._initState={colspan:a.colspan,rowspan:a.rowspan,col:a.column,row:a.row};break;case e.UI.DragDropEventType.End:this._gridBoxes.forEach(e=>{e.style.pointerEvents="none"});break;case e.UI.DragDropEventType.Over:var i=r.target,o=+i.style.gridColumnStart-1,n=+i.style.gridRowStart-1;const l=o+this._initState.colspan,c=n+this._initState.rowspan;if(!this._intersects(a,o,n,a.colspan,a.rowspan)){let e=!1;l<=(this.columns||s)&&(e=a.column!==o,a.column=o),c<=(this.rows||1)&&(e=e||a.row!==n,a.row=n)}}}),this._resizeHandler=(t=>{switch(t.type){case e.UI.RescaleEventType.Start:e.Utils.addClass(t.detail.element,e.PCSS+"-rescaling"),this._gridBoxes.forEach(e=>{e.style.pointerEvents="auto"});break;case e.UI.RescaleEventType.End:this._gridBoxes.forEach(e=>{e.style.pointerEvents="none"}),e.Utils.removeClass(t.detail.element,e.PCSS+"-rescaling");break;case e.UI.RescaleEventType.Rescale:t.preventDefault();const a=t.detail.currentPosition,i=t.detail.handle,o=document.elementsFromPoint(a.x,a.y).find(e=>this._dragDrop.dropTargets.indexOf(e)>=0);if(o){var r=+o.style.gridColumnStart,s=+o.style.gridRowStart;const e=t.detail.element,a=e.column+1,n=e.row+1,l=1+r-a,c=1+s-n;if(!this._intersects(e,e.column,e.row,l,c)){let t=!1;r>=a&&i.endsWith("right")&&(t=e.colspan!==l,e.colspan=l),s>=n&&i.startsWith("bottom")&&(t=t||e.rowspan!==c,e.rowspan=c)}}}}),this._gridBoxes=[]}register(t){let r=super.register(t);if(r){const r=t.row||0,s=t.column||0,a=t.colspan||2,i=t.rowspan||1;let o=!this._intersects(t,s,r,a,i);if(o)t.row=r,t.column=s,t.colspan=a,t.rowspan=i;else{if(!o){let e=(e=!1)=>{let r=this.columns-1;e||(r=r-a+1);for(let e=0;e<this.rows;e++){for(let s=0;s<=r;s++)if(!this._intersects(t,s,e,a,i)){t.column=s,t.row=e,t.colspan=Math.min(r+1-s,a),t.rowspan=i,o=!0;break}if(o)break}};e(),!o&&a>1&&e(!0)}o||(this.rows++,t.row=this.rows-1,t.column=0)}t.behaviors=[this._dragDrop,this._rescaler],t.addEventListener(e.PropertyChangeEventName,this._widgetPropertyChange,!1)}return r}unregister(t){let r=super.unregister(t);if(r){t.removeEventListener(e.PropertyChangeEventName,this._widgetPropertyChange,!1);const r=t.behaviors.indexOf(this._dragDrop);r>=0&&t.behaviors.splice(r,1);const s=t.behaviors.indexOf(this._rescaler);s>=0&&t.behaviors.splice(s,1)}return r}_intersects(e,t,r,s,a){for(let i of this.items){let o=i;if(o!==e&&(o.column<t+s&&o.column+o.colspan>t&&o.row<r+a&&o.row+o.rowspan>r))return!0}return!1}connectedCallback(){super.connectedCallback(),e.Utils.addClass(this,e.PCSS+"-grid");let r=this._dragDrop=document.createElement(e.P+"-drag-drop"),s=document.createElement("div");document.body.appendChild(s),r.floater=s,r.mode=e.UI.DragDataMode.Alias,r.dropBehavior=e.UI.DropBehavior.None,r.addEventListener(e.UI.DragDropEventType.Start,this._dragDropHandler,!1),r.addEventListener(e.UI.DragDropEventType.Over,this._dragDropHandler,!1),r.addEventListener(e.UI.DragDropEventType.End,this._dragDropHandler,!1),document.body.appendChild(r);let a=this._rescaler=document.createElement(e.P+"-rescale");a.handles=[e.UI.RescaleHandle.Right,e.UI.RescaleHandle.Bottom],a.addEventListener(e.UI.RescaleEventType.Start,this._resizeHandler,!1),a.addEventListener(e.UI.RescaleEventType.Rescale,this._resizeHandler,!1),a.addEventListener(e.UI.RescaleEventType.End,this._resizeHandler,!1),document.body.appendChild(a),e.Utils.isNullOrEmpty(this.columns)&&(this.columns=t.GRID_COLUMNS),e.Utils.isNullOrEmpty(this.rows)&&(this.rows=1)}viewActivatedCallback(){super.viewActivatedCallback(),this.adapt()}propertyChangedCallback(e,t,r,s){super.propertyChangedCallback(e,t,r,s),this.adapt()}disconnectedCallback(){var t=this._dragDrop,r=this._rescaler;e.Utils.isNull(t)||(t.floater.remove(),t.removeEventListener(e.UI.DragDropEventType.Start,this._dragDropHandler,!1),t.removeEventListener(e.UI.DragDropEventType.Over,this._dragDropHandler,!1),t.removeEventListener(e.UI.DragDropEventType.End,this._dragDropHandler,!1),t.remove(),this._dragDrop=null),e.Utils.isNull(r)||(r.removeEventListener(e.UI.RescaleEventType.Start,this._resizeHandler,!1),r.removeEventListener(e.UI.RescaleEventType.Rescale,this._resizeHandler,!1),r.removeEventListener(e.UI.RescaleEventType.End,this._resizeHandler,!1),r.remove(),this._rescaler=null),super.disconnectedCallback()}_normalize(e,t=1){return"string"==typeof e?e:(null==e&&(e=t),this.unitPixels(e)+"px")}unitPixels(e){return e*(this.unit||8)}adapt(){this.style.marginTop=this.unitPixels(this.marginTop||0)+"px",this.style.marginBottom=this.unitPixels(this.marginBottom||0)+"px",this.style.gridTemplateColumns=`repeat(${this.columns||s}, 1fr)`;let e=this._normalize(this.minRowheight,3),t=this._normalize(this.rowheight||"auto");this.style.gridTemplateRows=`repeat(${this.rows||1}, minmax(${e}, ${t}))`,this.style.gridRowGap=this._normalize(this.rowGap,1),this.style.gridColumnGap=this._normalize(this.columnGap,1),this._setGridLines()}_setGridLines(){var t=0;const a=this.editing;if(a){const e=this.columns||s,a=e*(this.rows||1);t=a;for(let t=0;t<a;t++){for(;this._gridBoxes.length<=t;){let e=r();this.appendChild(e),this._gridBoxes.push(e)}let s=this._gridBoxes[t];const a=t%e,i=Math.floor(t/e);s.style.gridColumn=(a+1).toString(),s.style.gridRow=(i+1).toString()}}for(let e of this._gridBoxes.splice(t))e.remove();e.Utils.isNull(this._dragDrop)||e.Utils.isNull(this._rescaler)||(this._dragDrop.disabled=this._rescaler.disabled=!a,this._dragDrop.dropTargets=this._gridBoxes)}};__decorate([e.Watch({emit:!1,reflectBack:!0,converter:e.PropertyConverters.Number})],i.prototype,"unit",void 0),__decorate([e.Watch({emit:!1,reflectBack:!0,converter:e.PropertyConverters.Number})],i.prototype,"marginTop",void 0),__decorate([e.Watch({emit:!1,reflectBack:!0,converter:e.PropertyConverters.Number})],i.prototype,"marginBottom",void 0),__decorate([e.Watch({emit:!1,reflectBack:!0,converter:e.PropertyConverters.Number})],i.prototype,"columns",void 0),__decorate([e.Watch({emit:!1,reflectBack:!0,converter:e.PropertyConverters.Number})],i.prototype,"rows",void 0),__decorate([e.Watch({emit:!1,reflectBack:!0,converter:e.PropertyConverters.String})],i.prototype,"minRowheight",void 0),__decorate([e.Watch({emit:!1,reflectBack:!0,converter:e.PropertyConverters.String})],i.prototype,"rowheight",void 0),__decorate([e.Watch({emit:!1,reflectBack:!0,converter:e.PropertyConverters.Number})],i.prototype,"rowGap",void 0),__decorate([e.Watch({emit:!1,reflectBack:!0,converter:e.PropertyConverters.Number})],i.prototype,"columnGap",void 0),__decorate([e.Debounce(100)],i.prototype,"adapt",null),i=__decorate([e.CustomElement({tagName:e.P+"-widget-grid"})],i),t.PacemGridWidgetElement=i}(t.Cms||(t.Cms={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={})),function(e){!function(t){!function(t){const r={display:{name:"DataColumn"},props:[{prop:"header",type:"string",display:{name:"Header"}},{prop:"content",type:"string",display:{ui:"expression",name:"Content"},extra:t.EXPRESSION_WIDGET_METADATA_EXTRA}]},s=t.buildWidgetMetadata({display:{icon:"table_chart",name:"DataGrid",description:"DataGrid widget."},props:[{prop:"datasource",type:"complex",display:{ui:"expression",name:"Datasource"},extra:e.Utils.extend({},t.EXPRESSION_WIDGET_METADATA_EXTRA,{filter:e=>e instanceof t.PacemWidgetDataElement||e instanceof t.PacemWidgetFetchElement})},{prop:"columns",type:"array",display:{name:"Columns"},extra:{dependsOn:[{prop:"datasource",hide:!0}]},props:t.gridifyMetadata(r)}]});let a=class PacemWidgetDataGridElement extends t.PacemUiWidgetElement{constructor(){super(s),this.columns=[]}_gridify(e=this.columns){var t="";for(let r of e||[]){const e=r.width||1;t+="number"==typeof e?e+"fr ":"auto "}return t}propertyChangedCallback(e,t,r,s){switch(super.propertyChangedCallback(e,t,r,s),e){case"columns":this._setupHeadcells()}}_setupHeadcells(){}};__decorate([e.Watch({converter:e.PropertyConverters.Json})],a.prototype,"columns",void 0),__decorate([e.ViewChild("template")],a.prototype,"_template",void 0),a=__decorate([e.CustomElement({tagName:e.P+"-widget-datagrid",shadow:e.Defaults.USE_SHADOW_ROOT,template:`<${e.P}-repeater datasource="{{ :host.columns }}">\n    <${e.P}-panel class="${e.PCSS}-datatable" css="{{ {'grid-template-columns': :host._gridify(:host.columns)} }}">\n    \x3c!--pacem-datagrid-heading--\x3e\n    <template>\n        <${e.P}-panel class="${e.PCSS}-headcell" content="{{ ^item.header }}"></${e.P}-panel>\n    </template>\n</${e.P}-panel></${e.P}-repeater>`})],a),t.PacemWidgetDataGridElement=a}(t.Cms||(t.Cms={}))}(e.Components||(e.Components={}))}(Pacem||(Pacem={}));